"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[5391],{5391:(k,Z,l)=>{l.r(Z),l.d(Z,{MessagesModule:()=>K});var g=l(6895),m=l(8781),c=l(5861),i=l(8058),U=l(4004),e=l(4650),C=l(8534),M=l(1560),f=l(4006);const T=["scheduleList"];function x(t,r){1&t&&(e.TgZ(0,"ion-buttons",12),e._uU(1,"\n      "),e._UZ(2,"ion-menu-button"),e._uU(3,"\n    "),e.qZA())}function b(t,r){if(1&t){const n=e.EpF();e.TgZ(0,"ion-segment",13),e.NdJ("ngModelChange",function(s){e.CHM(n);const a=e.oxw();return e.KtG(a.segment=s)})("ionChange",function(){e.CHM(n);const s=e.oxw();return e.KtG(s.updateList())}),e._uU(1,"\n      "),e.TgZ(2,"ion-segment-button",14),e._uU(3," Inbox "),e.qZA(),e._uU(4,"\n      "),e.TgZ(5,"ion-segment-button",15),e._uU(6," Sent "),e.qZA(),e._uU(7,"\n      "),e.TgZ(8,"ion-segment-button",16),e._uU(9," Deleted "),e.qZA(),e._uU(10,"\n    "),e.qZA()}if(2&t){const n=e.oxw();e.Q6J("ngModel",n.segment)}}function A(t,r){1&t&&(e.TgZ(0,"ion-title"),e._uU(1,"Messages"),e.qZA())}function q(t,r){if(1&t){const n=e.EpF();e.TgZ(0,"ion-searchbar",17),e.NdJ("ngModelChange",function(s){e.CHM(n);const a=e.oxw();return e.KtG(a.queryText=s)})("ionChange",function(){e.CHM(n);const s=e.oxw();return e.KtG(s.updateList())})("ionCancel",function(){e.CHM(n);const s=e.oxw();return e.KtG(s.showSearchbar=!1)}),e.qZA()}if(2&t){const n=e.oxw();e.Q6J("ngModel",n.queryText)}}function y(t,r){if(1&t){const n=e.EpF();e.TgZ(0,"ion-button",18),e.NdJ("click",function(){e.CHM(n);const s=e.oxw();return e.KtG(s.showSearchbar=!0)}),e._uU(1,"\n        "),e._UZ(2,"ion-icon",19),e._uU(3,"\n      "),e.qZA()}}function v(t,r){if(1&t){const n=e.EpF();e.TgZ(0,"ion-toolbar"),e._uU(1,"\n    "),e.TgZ(2,"ion-segment",13),e.NdJ("ngModelChange",function(s){e.CHM(n);const a=e.oxw();return e.KtG(a.segment=s)})("ionChange",function(){e.CHM(n);const s=e.oxw();return e.KtG(s.updateList())}),e._uU(3,"\n      "),e.TgZ(4,"ion-segment-button",14),e._uU(5," Inbox "),e.qZA(),e._uU(6,"\n      "),e.TgZ(7,"ion-segment-button",15),e._uU(8," Sent "),e.qZA(),e._uU(9,"\n      "),e.TgZ(10,"ion-segment-button",16),e._uU(11," Deleted "),e.qZA(),e._uU(12,"\n    "),e.qZA(),e._uU(13,"\n  "),e.qZA()}if(2&t){const n=e.oxw();e.xp6(2),e.Q6J("ngModel",n.segment)}}function w(t,r){if(1&t&&(e.TgZ(0,"ion-item-sliding",null,22),e._uU(2,"\n      "),e.TgZ(3,"ion-item",23),e._uU(4,"\n        "),e.TgZ(5,"ion-label"),e._uU(6,"\n          "),e.TgZ(7,"h3"),e._uU(8),e.qZA(),e._uU(9,"\n          "),e.TgZ(10,"p"),e._uU(11),e.qZA(),e._uU(12,"\n        "),e.qZA(),e._uU(13,"\n        "),e._uU(14,"\n      "),e.qZA(),e._uU(15,"\n    "),e.qZA()),2&t){const n=r.$implicit;e.xp6(3),e.MGl("routerLink","/messages/details/",n.contact,""),e.xp6(5),e.Oqu(n.contact),e.xp6(3),e.Oqu(n.messages[0].message_body)}}function J(t,r){if(1&t&&(e.TgZ(0,"ion-list",null,20),e._uU(2,"\n    "),e.YNc(3,w,16,3,"ion-item-sliding",21),e._uU(4,"\n  "),e.qZA()),2&t){const n=e.oxw();e.xp6(3),e.Q6J("ngForOf",n.messageGroups)}}function N(t,r){if(1&t){const n=e.EpF();e._uU(0,"\n      "),e.TgZ(1,"ion-header"),e._uU(2,"\n        "),e.TgZ(3,"ion-toolbar"),e._uU(4,"\n          "),e.TgZ(5,"ion-buttons",12),e._uU(6,"\n            "),e.TgZ(7,"ion-button",18),e.NdJ("click",function(){e.CHM(n);const s=e.oxw();return e.KtG(s.cancel())}),e._uU(8,"Cancel"),e.qZA(),e._uU(9,"\n          "),e.qZA(),e._uU(10,"\n          "),e.TgZ(11,"ion-title"),e._uU(12,"Add Client"),e.qZA(),e._uU(13,"\n          "),e.TgZ(14,"ion-buttons",5),e._uU(15,"\n            "),e.TgZ(16,"ion-button",24),e.NdJ("click",function(){e.CHM(n);const s=e.oxw();return e.KtG(s.create())}),e._uU(17,"Confirm"),e.qZA(),e._uU(18,"\n          "),e.qZA(),e._uU(19,"\n        "),e.qZA(),e._uU(20,"\n      "),e.qZA(),e._uU(21,"\n      "),e.TgZ(22,"ion-content",25),e._uU(23,"\n        "),e.TgZ(24,"ion-list"),e._uU(25,"\n          "),e.TgZ(26,"ion-item"),e._uU(27,"\n            "),e.TgZ(28,"ion-label",26),e._uU(29,"First Name"),e.qZA(),e._uU(30,"\n            "),e.TgZ(31,"ion-input",27),e.NdJ("ngModelChange",function(s){e.CHM(n);const a=e.oxw();return e.KtG(a.record.first_name=s)}),e.qZA(),e._uU(32,"\n          "),e.qZA(),e._uU(33,"\n\n          "),e.TgZ(34,"ion-item"),e._uU(35,"\n            "),e.TgZ(36,"ion-label",26),e._uU(37,"Last Name"),e.qZA(),e._uU(38,"\n            "),e.TgZ(39,"ion-input",28),e.NdJ("ngModelChange",function(s){e.CHM(n);const a=e.oxw();return e.KtG(a.record.last_name=s)}),e.qZA(),e._uU(40,"\n          "),e.qZA(),e._uU(41,"\n\n          "),e.TgZ(42,"ion-item"),e._uU(43,"\n            "),e.TgZ(44,"ion-label",26),e._uU(45,"Nick Name"),e.qZA(),e._uU(46,"\n            "),e.TgZ(47,"ion-input",29),e.NdJ("ngModelChange",function(s){e.CHM(n);const a=e.oxw();return e.KtG(a.record.nick_name=s)}),e.qZA(),e._uU(48,"\n          "),e.qZA(),e._uU(49,"\n\n          "),e.TgZ(50,"ion-item"),e._uU(51,"\n            "),e.TgZ(52,"ion-label",26),e._uU(53,"Birthday"),e.qZA(),e._uU(54,"\n            "),e.TgZ(55,"ion-input",30),e.NdJ("ngModelChange",function(s){e.CHM(n);const a=e.oxw();return e.KtG(a.record.date_of_birth=s)}),e.qZA(),e._uU(56,"\n          "),e.qZA(),e._uU(57,"\n        "),e.qZA(),e._uU(58,"\n      "),e.qZA(),e._uU(59,"\n    ")}if(2&t){const n=e.oxw();e.xp6(16),e.Q6J("strong",!0),e.xp6(15),e.Q6J("ngModel",n.record.first_name),e.xp6(8),e.Q6J("ngModel",n.record.last_name),e.xp6(8),e.Q6J("ngModel",n.record.nick_name),e.xp6(8),e.Q6J("ngModel",n.record.date_of_birth)}}function Y(t,r){1&t&&(e.TgZ(0,"ion-buttons",7),e._uU(1,"\n      "),e._UZ(2,"ion-back-button",8),e._uU(3,"\n      "),e._uU(4,"\n    "),e.qZA()),2&t&&(e.xp6(2),e.Q6J("defaultHref","/clients"))}function S(t,r){if(1&t&&(e.TgZ(0,"ion-title"),e._uU(1),e.qZA()),2&t){const n=e.oxw();e.xp6(1),e.Oqu(n.record.contact)}}function G(t,r){if(1&t&&(e.TgZ(0,"ion-title",9),e._uU(1),e.qZA()),2&t){const n=e.oxw();e.xp6(1),e.Oqu(n.record.contact)}}function O(t,r){if(1&t&&(e.TgZ(0,"ion-item"),e._uU(1,"\n      "),e.TgZ(2,"ion-label",12),e._uU(3,"\n        "),e.TgZ(4,"div",13),e._uU(5,"\n          "),e.TgZ(6,"ion-badge"),e._uU(7),e.qZA(),e._uU(8,"\n        "),e.qZA(),e._uU(9,"\n      "),e.qZA(),e._uU(10,"\n    "),e.qZA()),2&t){const n=r.$implicit;e.xp6(7),e.Oqu(n.message_body)}}function Q(t,r){if(1&t&&(e.TgZ(0,"ion-list",10),e._uU(1,"\n    "),e.YNc(2,O,11,1,"ion-item",11),e._uU(3,"\n  "),e.qZA()),2&t){const n=r.ngIf;e.xp6(2),e.Q6J("ngForOf",n)}}const D=[{path:"",component:(()=>{class t{constructor(n,o,s,a,_,u,p,d,h){this.alertCtrl=n,this.loadingCtrl=o,this.modalCtrl=s,this.router=a,this.routerOutlet=_,this.toastCtrl=u,this.dataService=p,this.credService=d,this.config=h,this.ios=!1,this.dayIndex=0,this.queryText="",this.segment="inbox",this.excludeTracks=[],this.shownSessions=[],this.groups=[],this.confDate="",this.showSearchbar=!1,this.loading=!0,this.loadingOverlay=null,this.messageGroups=[],this.record={},this.user={}}ngOnInit(){var n=this;return(0,c.Z)(function*(){n.ios="ios"===n.config.get("mode"),yield n.updateList()})()}groupByKey(n,o){return(0,c.Z)(function*(){return n.reduce((s,a)=>void 0===a[o]?s:Object.assign(s,{[a[o]]:(s[a[o]]||[]).concat(a)}),{})})()}updateList(){var n=this;return(0,c.Z)(function*(){var o;n.loading=!0,n.loadingOverlay=yield n.loadingCtrl.create(),yield n.loadingOverlay.present();const s=n.credService.credentials;n.user=yield n.dataService.getRecord("users",s.profile._id),n.records$=n.dataService.records$("messages",{folder:n.segment,message_sent_to:n.user.assigned_phone_number,$sort:{created:-1}}).pipe((0,U.U)(a=>a.data)),n.records$.subscribe(function(a){return(o=o||(0,c.Z)(function*(_){const u=yield n.groupByKey(_,"message_from"),p=Object.keys(u);n.messageGroups=[];for(let d of p)console.log(d),n.messageGroups.push({contact:d,messages:u[d]});console.log(n.messageGroups),n.loading=!1,n.loadingOverlay.dismiss()})).apply(this,arguments)})})()}presentFilter(){}addFavorite(n,o){}removeFavorite(n,o,s){}presentAddParticipant(){}openSocial(n,o){}cancel(){this.modal.dismiss(null,"cancel")}create(){return(0,c.Z)(function*(){})()}onWillDismiss(n){}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(i.Br),e.Y36(i.HT),e.Y36(i.IN),e.Y36(m.F0),e.Y36(i.jP),e.Y36(i.yF),e.Y36(C.D),e.Y36(M.Cs),e.Y36(i.De))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-messages"]],viewQuery:function(n,o){if(1&n&&(e.Gf(T,7),e.Gf(i.ki,5)),2&n){let s;e.iGM(s=e.CRH())&&(o.scheduleList=s.first),e.iGM(s=e.CRH())&&(o.modal=s.first)}},decls:47,vars:10,consts:[["translucent","true"],["slot","start",4,"ngIf"],[3,"ngModel","ngModelChange","ionChange",4,"ngIf"],[4,"ngIf"],["showCancelButton","always","placeholder","Search",3,"ngModel","ngModelChange","ionChange","ionCancel",4,"ngIf"],["slot","end"],[3,"click",4,"ngIf"],["fullscreen","true"],["collapse","condense"],["size","large"],["placeholder","Search",3,"ngModel","ngModelChange","ionChange"],["trigger","open-modal",3,"willDismiss"],["slot","start"],[3,"ngModel","ngModelChange","ionChange"],["value","inbox"],["value","sent"],["value","deleted"],["showCancelButton","always","placeholder","Search",3,"ngModel","ngModelChange","ionChange","ionCancel"],[3,"click"],["slot","icon-only","name","search"],["scheduleList",""],[4,"ngFor","ngForOf"],["slidingItem",""],[3,"routerLink"],[3,"strong","click"],[1,"ion-padding"],["position","stacked"],["type","text","placeholder","First Name",3,"ngModel","ngModelChange"],["type","text","placeholder","Last Name",3,"ngModel","ngModelChange"],["type","text","placeholder","Nick Name",3,"ngModel","ngModelChange"],["type","text","placeholder","Birthday",3,"ngModel","ngModelChange"]],template:function(n,o){1&n&&(e.TgZ(0,"ion-header",0),e._uU(1,"\n  "),e.TgZ(2,"ion-toolbar"),e._uU(3,"\n    "),e.YNc(4,x,4,0,"ion-buttons",1),e._uU(5,"\n    "),e.YNc(6,b,11,1,"ion-segment",2),e._uU(7,"\n    "),e.YNc(8,A,2,0,"ion-title",3),e._uU(9,"\n    "),e.YNc(10,q,1,1,"ion-searchbar",4),e._uU(11,"\n    "),e.TgZ(12,"ion-buttons",5),e._uU(13,"\n      "),e.YNc(14,y,4,0,"ion-button",6),e._uU(15,"\n    "),e.qZA(),e._uU(16,"\n  "),e.qZA(),e._uU(17,"\n  "),e.YNc(18,v,14,1,"ion-toolbar",3),e._uU(19,"\n"),e.qZA(),e._uU(20,"\n\n"),e.TgZ(21,"ion-content",7),e._uU(22,"\n  "),e.TgZ(23,"ion-header",8),e._uU(24,"\n    "),e.TgZ(25,"ion-toolbar"),e._uU(26,"\n      "),e.TgZ(27,"ion-title",9),e._uU(28,"Messages"),e.qZA(),e._uU(29,"\n    "),e.qZA(),e._uU(30,"\n    "),e.TgZ(31,"ion-toolbar"),e._uU(32,"\n      "),e.TgZ(33,"ion-searchbar",10),e.NdJ("ngModelChange",function(a){return o.queryText=a})("ionChange",function(){return o.updateList()}),e.qZA(),e._uU(34,"\n    "),e.qZA(),e._uU(35,"\n  "),e.qZA(),e._uU(36,"\n\n  "),e.YNc(37,J,5,1,"ion-list",3),e.ALo(38,"async"),e._uU(39,"\n\n  "),e.TgZ(40,"ion-modal",11),e.NdJ("willDismiss",function(a){return o.onWillDismiss(a)}),e._uU(41,"\n    "),e.YNc(42,N,60,5,"ng-template"),e._uU(43,"\n  "),e.qZA(),e._uU(44,"\n\n  "),e._uU(45,"\n"),e.qZA(),e._uU(46,"\n")),2&n&&(e.xp6(4),e.Q6J("ngIf",!o.showSearchbar),e.xp6(2),e.Q6J("ngIf",o.ios),e.xp6(2),e.Q6J("ngIf",!o.ios&&!o.showSearchbar),e.xp6(2),e.Q6J("ngIf",o.showSearchbar),e.xp6(4),e.Q6J("ngIf",!o.ios&&!o.showSearchbar),e.xp6(4),e.Q6J("ngIf",!o.ios),e.xp6(15),e.Q6J("ngModel",o.queryText),e.xp6(4),e.Q6J("ngIf",e.lcZ(38,8,o.records$)))},dependencies:[g.sg,g.O5,f.JJ,f.On,i.YG,i.Sm,i.W2,i.Gu,i.gu,i.pK,i.Ie,i.td,i.Q$,i.q_,i.fG,i.VI,i.cJ,i.GO,i.wd,i.sr,i.ki,i.QI,i.j9,i.YI,m.rH,g.Ov]}),t})()},{path:"details/:id",component:(()=>{class t{constructor(n,o,s,a,_,u,p,d,h,L){this.alertCtrl=n,this.loadingCtrl=o,this.modalCtrl=s,this.router=a,this.route=_,this.routerOutlet=u,this.toastController=p,this.dataService=d,this.credService=h,this.config=L,this.ios=!1,this.dayIndex=0,this.queryText="",this.segment="all",this.excludeTracks=[],this.shownSessions=[],this.groups=[],this.confDate="",this.showSearchbar=!1,this.loading=!0,this.loadingOverlay=null,this.record={},this.user={}}ngOnInit(){this.ios="ios"===this.config.get("mode"),this.getData()}getData(){var n=this;return(0,c.Z)(function*(){var o;n.loading=!0,n.record={},n.loadingOverlay=yield n.loadingCtrl.create(),yield n.loadingOverlay.present();const s=n.credService.credentials;n.user=yield n.dataService.getRecord("users",s.profile._id),console.log(n.user),n.route.params.subscribe(function(a){return(o=o||(0,c.Z)(function*(_){console.log(_),n.record={contact:_.id},console.log(n.record),n.records$=n.dataService.records$("messages",{message_sent_to:n.user.assigned_phone_number,message_from:_.id,$sort:{created:-1}}).pipe((0,U.U)(u=>u.data)),n.records$.subscribe(u=>{console.log(u)}),n.loading=!1,n.loadingOverlay.dismiss()})).apply(this,arguments)})})()}}return t.\u0275fac=function(n){return new(n||t)(e.Y36(i.Br),e.Y36(i.HT),e.Y36(i.IN),e.Y36(m.F0),e.Y36(m.gz),e.Y36(i.jP),e.Y36(i.yF),e.Y36(C.D),e.Y36(M.Cs),e.Y36(i.De))},t.\u0275cmp=e.Xpm({type:t,selectors:[["app-message-details"]],decls:24,vars:6,consts:[["translucent","true"],["slot","start",4,"ngIf"],[4,"ngIf"],["fullscreen","true"],["collapse","condense"],["size","large",4,"ngIf"],["lines","none",4,"ngIf"],["slot","start"],[3,"defaultHref"],["size","large"],["lines","none"],[4,"ngFor","ngForOf"],[1,"ion-text-wrap"],[1,"flex-container"]],template:function(n,o){1&n&&(e.TgZ(0,"ion-header",0),e._uU(1,"\n  "),e.TgZ(2,"ion-toolbar"),e._uU(3,"\n    "),e.YNc(4,Y,5,1,"ion-buttons",1),e._uU(5,"\n    "),e.YNc(6,S,2,1,"ion-title",2),e._uU(7,"\n  "),e.qZA(),e._uU(8,"\n"),e.qZA(),e._uU(9,"\n\n"),e.TgZ(10,"ion-content",3),e._uU(11,"\n  "),e.TgZ(12,"ion-header",4),e._uU(13,"\n    "),e.TgZ(14,"ion-toolbar"),e._uU(15,"\n      "),e.YNc(16,G,2,1,"ion-title",5),e._uU(17,"\n    "),e.qZA(),e._uU(18,"\n  "),e.qZA(),e._uU(19,"\n\n  "),e.YNc(20,Q,4,1,"ion-list",6),e.ALo(21,"async"),e._uU(22,"\n"),e.qZA(),e._uU(23,"\n")),2&n&&(e.xp6(4),e.Q6J("ngIf",!o.showSearchbar),e.xp6(2),e.Q6J("ngIf",!o.ios&&!o.showSearchbar&&!o.loading),e.xp6(10),e.Q6J("ngIf",!o.loading),e.xp6(4),e.Q6J("ngIf",e.lcZ(21,4,o.records$)))},dependencies:[g.sg,g.O5,i.oU,i.yp,i.Sm,i.W2,i.Gu,i.Ie,i.Q$,i.q_,i.wd,i.sr,i.cs,g.Ov]}),t})()}];let F=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[m.Bz.forChild(D),m.Bz]}),t})();var H=l(6430);let K=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=e.oAB({type:t}),t.\u0275inj=e.cJS({imports:[g.ez,H.m8,f.u5,f.UX,i.Pc,F]}),t})()}}]);